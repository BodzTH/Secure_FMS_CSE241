# ğŸ” Security Information System - Quick Start Guide

## âœ… Setup Complete!

Your authentication system is ready with MongoDB integration.

---

## ğŸ“‹ What's Included

### âœ¨ Features:
- âœ… User Registration with firstName, lastName, email, password
- âœ… User Login with JWT token generation
- âœ… Password Hashing (bcrypt with 10 salt rounds)
- âœ… Login Attempt Limiting (5 attempts, 15 min lockout)
- âœ… JWT Authentication Middleware (ready for Person 2 & 3)
- âœ… File Encryption/Decryption Utility (AES-256-CBC)
- âœ… MongoDB Database with Mongoose

---

## ğŸš€ How to Run

### 1. Install MongoDB (if not installed):
```bash
# Download from: https://www.mongodb.com/try/download/community
# Or install via Chocolatey:
choco install mongodb
```

### 2. Start MongoDB:
```bash
# Start MongoDB service
net start MongoDB

# Or run manually:
mongod
```

### 3. Install Dependencies:
```bash
npm install
```

### 4. Setup Environment:
Copy `.env.example` to `.env` and update values (already done âœ…)

### 5. Start Server:
```bash
node app.js
```

**Expected Output:**
```
Server running on port 3000
MongoDB Connected: localhost
```

---

## ğŸ§ª Test the API

### Register New User:
```bash
# Using curl (PowerShell):
Invoke-RestMethod -Uri "http://localhost:3000/api/auth/register" -Method POST -Headers @{"Content-Type"="application/json"} -Body '{"firstName":"Ahmed","lastName":"Mohamed","email":"ahmed@example.com","password":"12345678"}'
```

**Or use Thunder Client in VS Code:**
```
POST http://localhost:3000/api/auth/register
Content-Type: application/json

{
  "firstName": "Ahmed",
  "lastName": "Mohamed",
  "email": "ahmed@example.com",
  "password": "12345678"
}
```

**Expected Response:**
```json
{
  "message": "User registered successfully",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": "507f1f77bcf86cd799439011",
    "firstName": "Ahmed",
    "lastName": "Mohamed",
    "email": "ahmed@example.com",
    "role": "user"
  }
}
```

### Login User:
```
POST http://localhost:3000/api/auth/login
Content-Type: application/json

{
  "email": "ahmed@example.com",
  "password": "12345678"
}
```

**Expected Response:**
```json
{
  "message": "Login successful",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": "507f1f77bcf86cd799439011",
    "firstName": "Ahmed",
    "lastName": "Mohamed",
    "email": "ahmed@example.com",
    "role": "user"
  }
}
```

---

## ğŸ“Š Database Schema (for Frontend Team)

### User Fields:
| Field          | Type   | Required | Validation              |
|----------------|--------|----------|-------------------------|
| **firstName**  | String | âœ…       | Non-empty, trimmed      |
| **lastName**   | String | âœ…       | Non-empty, trimmed      |
| **email**      | String | âœ…       | Valid email, unique     |
| **password**   | String | âœ…       | **Min 8 characters**    |

### API Endpoints:
- **Register**: `POST /api/auth/register`
- **Login**: `POST /api/auth/login`

### Token Usage:
All protected routes need this header:
```
Authorization: Bearer YOUR_JWT_TOKEN_HERE
```

---

## ğŸ›¡ï¸ For Person 2 & Person 3 (File Management Team)

### Use Authentication Middleware:
```javascript
const authMiddleware = require('./middleware/authMiddleware');

// Protected route example
router.post('/upload', authMiddleware, uploadController.uploadFile);
router.get('/download/:id', authMiddleware, downloadController.downloadFile);
```

### Access User Info in Controllers:
```javascript
exports.yourFunction = (req, res) => {
  // req.user contains decoded JWT data
  const { userId, email, firstName, lastName } = req.user;
  
  // Use userId to associate files with users
  console.log(`User ${firstName} ${lastName} (${userId}) is uploading a file`);
};
```

### Use File Encryption:
```javascript
const { encryptBuffer, decryptBuffer } = require('./utils/fileCrypto');

// On Upload (Person 2):
const encryptedFile = encryptBuffer(req.file.buffer);
// Save encryptedFile to disk

// On Download (Person 3):
const originalFile = decryptBuffer(encryptedFileFromDisk);
// Send originalFile to user
```

---

## ğŸ“ Project Structure
```
security-information-system/
â”œâ”€â”€ config/
â”‚   â””â”€â”€ db.js                 # MongoDB connection
â”œâ”€â”€ models/
â”‚   â””â”€â”€ User.js               # User schema with password hashing
â”œâ”€â”€ controllers/
â”‚   â””â”€â”€ authController.js     # Register & Login logic
â”œâ”€â”€ middleware/
â”‚   â””â”€â”€ authMiddleware.js     # JWT verification
â”œâ”€â”€ routes/
â”‚   â””â”€â”€ authRoutes.js         # Auth endpoints
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ fileCrypto.js         # AES-256 encryption/decryption
â”œâ”€â”€ .env                      # Environment variables (DO NOT COMMIT)
â”œâ”€â”€ .env.example              # Template for .env
â”œâ”€â”€ app.js                    # Main server file
â””â”€â”€ package.json              # Dependencies
```

---

## ğŸ” Security Features

âœ… **Bcrypt Password Hashing** - Automatic via Mongoose pre-save hook  
âœ… **JWT Authentication** - 24-hour token expiration  
âœ… **Login Attempt Limiting** - 5 failed attempts = 15 min lockout  
âœ… **Email Validation** - Unique index + regex validation  
âœ… **Password Requirements** - Minimum 8 characters  
âœ… **AES-256-CBC Encryption** - Ready for file encryption  

---

## ğŸ“ Validation Rules

### Registration:
- âŒ Missing fields â†’ `400 Bad Request`
- âŒ Password < 8 chars â†’ `400 Bad Request`
- âŒ Email already exists â†’ `409 Conflict`

### Login:
- âŒ Invalid credentials â†’ `401 Unauthorized`
- âŒ 5+ failed attempts â†’ `429 Too Many Requests` (15 min lockout)

---

## ğŸ“¦ Dependencies
```json
{
  "express": "^4.21.2",
  "mongoose": "latest",
  "bcrypt": "^5.1.1",
  "jsonwebtoken": "^9.0.2",
  "dotenv": "^16.4.7"
}
```

---

## ğŸ¯ Next Steps

### For Person 2 (File Upload):
1. Create `File` model in MongoDB
2. Use `authMiddleware` to protect upload routes
3. Use `encryptBuffer()` from `utils/fileCrypto.js` before saving files
4. Store file metadata (filename, size, uploadedBy: req.user.userId)

### For Person 3 (File Download):
1. Use `authMiddleware` to verify user identity
2. Check if user has permission to download file
3. Use `decryptBuffer()` to decrypt file before sending
4. Log download activity with `req.user.userId`

---

## ğŸ” Troubleshooting

### MongoDB Connection Error:
```bash
# Check if MongoDB is running:
Get-Service MongoDB

# Start MongoDB:
net start MongoDB
```

### Port Already in Use:
Change `PORT` in `.env` file:
```env
PORT=5000
```

### JWT Token Errors:
Ensure `JWT_SECRET` is set in `.env` file

---

## ğŸ“š Full API Documentation

See **API-SCHEMA.md** for complete endpoint documentation with all request/response examples.

---

## âœ¨ Ready to Share with Team!

Your authentication system is complete and ready for:
1. âœ… Frontend team to build registration/login forms
2. âœ… Person 2 to implement file upload
3. âœ… Person 3 to implement file download

**Server Status:** ğŸŸ¢ Running on port 3000
